<html><head>
<title>Abstract Engine - Test</title>
<meta http-equiv="content-type" content="text/html; charset=ISO-8859-1">

<script type="text/javascript" src="../abstract_engine.js"></script>

<script type="text/javascript">

    function webGLStart() {
        
		const engine     = new ae.core.AbstractEngine(
			document.getElementById("gl-canvas"));
		const sceneGraph = new ae.core.SceneGraph(engine);
		
		const mb       = new ae.mat.MaterialBuilder();
		const material = mb.setColor(mb.constF(1, 0, 1)).createMaterial(engine, "material");
		
		const camera = new ae.sg.Camera(sceneGraph, "camera").
			setNearClipDistance(0.1).
			setFarClipDistanceToInfinity();
		
		const object = new ae.sg.Model(sceneGraph, "object").
			setMesh(ae.mesh.createCubeA(1, true).createMesh(engine.gl)).
			setMaterial(material).
			setUpdateCallback((event) => {event.host.transformation.value.
				toIdentity().
				translate(0, 0, -5).
				rotateY(event.time / 50);
			});
		
		sceneGraph.root.addChild(camera);
		sceneGraph.root.addChild(object);
		
		engine.camera = camera;
		
		let red = 0, green = 0.33, blue = 0.66;
		
		engine.state.onNewFrame.addListener((event) => {
			
			red   += 0.01;
			green += 0.01;
			blue  += 0.01;
			
			engine.background.setDataD(
				red   - Math.floor(red),
				green - Math.floor(green),
				blue  - Math.floor(blue));
		});
		
		sceneGraph.onNewTopology.addListener((event) => event.host.print());
		
		engine.start();
    }

</script>


</head>


<body onload="webGLStart();">
    <canvas id="gl-canvas" style="border: none;" width="500" height="500"></canvas>
</body></html>